# fixtures/simple.rs Review

## TL;DR

- âœ… ç›®çš„: åŸºæœ¬çš„ãªæ•°å€¤æ¼”ç®—ã¨2Då¹¾ä½•ã®æœ€å°æ§‹æˆï¼ˆåŠ ç®—ã€ä¹—ç®—ã€ç‚¹ã€çŸ©å½¢ã®å¹…ãƒ»é«˜ã•ãƒ»é¢ç©ï¼‰ã‚’æä¾›
- âœ… å…¬é–‹API: **multiply**, **Rectangle**, **Rectangle::width**, **Rectangle::height**, **Rectangle::area**
- âš ï¸ è¤‡é›‘ç®‡æ‰€: æµ®å‹•å°æ•°ç‚¹æ¼”ç®—ã®ç‰¹æ®Šå€¤ï¼ˆNaN/Infinityï¼‰ä¼æ’­ã€`Rectangle`ã®å¤–éƒ¨ã‹ã‚‰ã®æ§‹ç¯‰ä¸å¯ï¼ˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ä¸åœ¨ï¼‰
- âš ï¸ é‡å¤§ãƒªã‚¹ã‚¯: `add`ã®i32ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼æŒ™å‹•ï¼ˆãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰ã§panicã€ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ã§ãƒ©ãƒƒãƒ—ï¼‰ã¨æµ®å‹•å°æ•°ç‚¹ã®NaNä¼æ’­
- ğŸ›¡ï¸ å®‰å…¨æ€§: unsafeãªã—ã€æ‰€æœ‰æ¨©ãƒ»å€Ÿç”¨ã¯å•é¡Œãªã—ã€ä¸¦è¡Œæ€§ãªã—
- ğŸ” æ”¹å–„ææ¡ˆ: `Rectangle`ã®å…¬é–‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿è¿½åŠ ã€`Point`ã®å…¬é–‹/éå…¬é–‹æ–¹é‡æ•´ç†ã€APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨ä¸å¤‰æ¡ä»¶ã®æ˜ç¤º

## Overview & Purpose

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€Rustã®åŸºæœ¬æ§‹æ–‡ãƒ»æ‰€æœ‰æ¨©/å€Ÿç”¨ã®æœ€å°ä¾‹ã¨ã—ã¦ã€å˜ç´”ãªæ•°å€¤æ¼”ç®—ï¼ˆi32ã®åŠ ç®—ã€f64ã®ä¹—ç®—ï¼‰ã¨ã€2æ¬¡å…ƒå¹¾ä½•ï¼ˆç‚¹ã€çŸ©å½¢ã®å¹…ãƒ»é«˜ã•ãƒ»é¢ç©ï¼‰ã®å®Ÿè£…ã‚’æä¾›ã—ã¾ã™ã€‚å…¬é–‹APIã¯å¤–éƒ¨ã‹ã‚‰å‘¼ã¹ã‚‹æ¼”ç®—ï¼ˆmultiplyï¼‰ã¨ã€çŸ©å½¢ã®å¯¸æ³•è¨ˆç®—ï¼ˆwidth/height/areaï¼‰ã«é™å®šã•ã‚Œã¦ã„ã¾ã™ã€‚å†…éƒ¨çš„ã«ã¯`Point`å‹ã¨è·é›¢è¨ˆç®—ã‚’å‚™ãˆã¦ã„ã¾ã™ãŒå…¬é–‹ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

- add (éå…¬é–‹) [è¡Œ3-5]
- multiply (å…¬é–‹) [è¡Œ7-9]
- Point (éå…¬é–‹) ã¨ãã®implï¼ˆnew, distanceï¼‰ [è¡Œ11-26]
- Rectangle (å…¬é–‹) ã¨ãã®implï¼ˆwidth, height, areaï¼‰ [è¡Œ28-45]

## Structure & Key Components

| ç¨®åˆ¥ | åå‰ | å…¬é–‹ç¯„å›² | è²¬å‹™ | è¤‡é›‘åº¦ |
|------|------|----------|------|--------|
| Function | add | private | i32ã®åŠ ç®— | Low |
| Function | multiply | pub | f64ã®ä¹—ç®— | Low |
| Struct | Point | private | 2Dåº§æ¨™(x, y)ã®ä¿æŒ | Low |
| Method | Point::new | private | Pointã®ç”Ÿæˆ | Low |
| Method | Point::distance | private | 2ç‚¹é–“ã®è·é›¢ï¼ˆãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢ï¼‰è¨ˆç®— | Low |
| Struct | Rectangle | pub | çŸ©å½¢ï¼ˆå·¦ä¸Šãƒ»å³ä¸‹ã®Pointï¼‰ | Low |
| Method | Rectangle::width | pub | å¹…ã®è¨ˆç®— | Low |
| Method | Rectangle::height | pub | é«˜ã•ã®è¨ˆç®— | Low |
| Method | Rectangle::area | pub | é¢ç©ã®è¨ˆç®—ï¼ˆå¹…Ã—é«˜ã•ï¼‰ | Low |

### Dependencies & Interactions

- å†…éƒ¨ä¾å­˜
  - `Rectangle::area` â†’ `Rectangle::width`, `Rectangle::height`ï¼ˆ[è¡Œ42-44]ï¼‰
  - `Rectangle::{width,height}` â†’ `Rectangle`ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰`top_left`, `bottom_right`ï¼ˆ[è¡Œ34-40]ï¼‰
  - `Point::distance`ã¯`f64::sqrt`ã‚’ä½¿ç”¨ï¼ˆ[è¡Œ24]ï¼‰
- å¤–éƒ¨ä¾å­˜ï¼ˆæ¨™æº–ã®ã¿ï¼‰

| ã‚¯ãƒ¬ãƒ¼ãƒˆ/ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« | ç”¨é€” | å‚™è€ƒ |
|---------------------|------|------|
| stdï¼ˆãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ï¼‰ | f64ãƒ¡ã‚½ãƒƒãƒ‰(sqrt, abs), ç®—è¡“æ¼”ç®— | å¤–éƒ¨crateä¾å­˜ãªã— |

- è¢«ä¾å­˜æ¨å®š
  - `multiply`: æ±ç”¨çš„ãªæ•°å€¤æ¼”ç®—ï¼ˆæ•°å­¦å‡¦ç†ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°ï¼‰
  - `Rectangle`: GUI/ã‚²ãƒ¼ãƒ /ã‚¸ã‚ªãƒ¡ãƒˆãƒªè¨ˆç®—ã§ã®å¯¸æ³•å–å¾—ã€è¡çªåˆ¤å®šå‰å‡¦ç†
  - ç¾çŠ¶ã€å¤–éƒ¨ã‹ã‚‰`Rectangle`ã‚’æ§‹ç¯‰ã§ããªã„ãŸã‚ã€ä»–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒåˆ©ç”¨ã™ã‚‹ã«ã¯æœ¬ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã§ç”Ÿæˆã—ã¦è¿”å´ã™ã‚‹é–¢æ•°ãŒå¿…è¦ï¼ˆã“ã®ãƒãƒ£ãƒ³ã‚¯ã«ã¯ç¾ã‚Œãªã„ï¼‰

## API Surface (Public/Exported) and Data Contracts

| APIå | ã‚·ã‚°ãƒãƒãƒ£ | ç›®çš„ | Time | Space |
|-------|-----------|------|------|-------|
| multiply | `pub fn multiply(x: f64, y: f64) -> f64` | 2ã¤ã®f64ã‚’ä¹—ç®— | O(1) | O(1) |
| Rectangle | `pub struct Rectangle { top_left: Point, bottom_right: Point }` | çŸ©å½¢ã®å‹ï¼ˆå¯¸æ³•è¨ˆç®—ç”¨ï¼‰ | N/A | N/A |
| Rectangle::width | `pub fn width(&self) -> f64` | å¹…ã®å–å¾— | O(1) | O(1) |
| Rectangle::height | `pub fn height(&self) -> f64` | é«˜ã•ã®å–å¾— | O(1) | O(1) |
| Rectangle::area | `pub fn area(&self) -> f64` | é¢ç©ã®å–å¾— | O(1) | O(1) |

ä»¥ä¸‹ã€å„APIã®è©³ç´°ã§ã™ã€‚

### multiply

1) ç›®çš„ã¨è²¬å‹™
- 2ã¤ã®æµ®å‹•å°æ•°ç‚¹æ•°ã®ä¹—ç®—ã‚’è¡Œã„çµæœã‚’è¿”ã—ã¾ã™ã€‚

2) ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆã‚¹ãƒ†ãƒƒãƒ—åˆ†è§£ï¼‰
- å…¥åŠ›x, yã‚’å—ã‘å–ã‚Šã€`x * y`ã‚’è¿”ã™ï¼ˆ[è¡Œ7-9]ï¼‰ã€‚

3) å¼•æ•°

| å¼•æ•°å | å‹ | èª¬æ˜ |
|-------|----|------|
| x | f64 | ä¹—ç®—ã™ã‚‹å€¤ |
| y | f64 | ä¹—ç®—ã™ã‚‹å€¤ |

4) æˆ»ã‚Šå€¤

| å‹ | èª¬æ˜ |
|----|------|
| f64 | xã¨yã®ç©ã€‚NaN/Infinityã¯IEEE754ã«å¾“ã„ä¼æ’­ |

5) ä½¿ç”¨ä¾‹
```rust
fn main() {
    let v = fixtures::simple::multiply(3.0, -2.5);
    assert_eq!(v, -7.5);
}
```

6) ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹
- xã¾ãŸã¯yãŒNaNã®å ´åˆã€çµæœã¯NaN
- Infinityã¨0ã®ä¹—ç®—ã¯NaN
- éå¸¸ã«å¤§ãã„å€¤åŒå£«ã®ä¹—ç®—ã¯Infinityã«é£½å’Œã™ã‚‹å¯èƒ½æ€§

### Rectangleï¼ˆå‹ï¼‰

1) ç›®çš„ã¨è²¬å‹™
- å·¦ä¸Šã¨å³ä¸‹ã®2ç‚¹ã§çŸ©å½¢ã‚’è¡¨ç¾ã—ã€å¯¸æ³•è¨ˆç®—ï¼ˆå¹…ãƒ»é«˜ã•ãƒ»é¢ç©ï¼‰ã‚’æä¾›ã—ã¾ã™ã€‚

2) ãƒ‡ãƒ¼ã‚¿å¥‘ç´„ãƒ»ä¸å¤‰æ¡ä»¶ï¼ˆæ¨å¥¨ï¼‰
- ç¾çŠ¶ã€è§’ã®æ­£å½“æ€§ï¼ˆæœ¬å½“ã«ã€Œå·¦ä¸Šã€ã¨ã€Œå³ä¸‹ã€ã‹ï¼‰ã¯ä¸å¤‰ã¨ã—ã¦ä¿è¨¼ã—ã¦ã„ã¾ã›ã‚“ã€‚`width`/`height`ã¯çµ¶å¯¾å€¤ã§è¨ˆç®—ã•ã‚Œã‚‹ãŸã‚ã€åº§æ¨™ãŒé€†ã§ã‚‚éè² å€¤ã‚’è¿”ã—ã¾ã™ã€‚
- ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯éå…¬é–‹ï¼ˆ[è¡Œ28-31]ï¼‰ã€å‹`Point`ã‚‚éå…¬é–‹ï¼ˆ[è¡Œ11-14]ï¼‰ã€‚å¤–éƒ¨ã‹ã‚‰ã®ç›´æ¥æ§‹ç¯‰ã¯ä¸å¯ã€‚

3) ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹ | å…¬é–‹ | èª¬æ˜ |
|-------------|----|------|------|
| top_left | Point | private | å·¦ä¸Šåº§æ¨™ï¼ˆæƒ³å®šï¼‰ |
| bottom_right | Point | private | å³ä¸‹åº§æ¨™ï¼ˆæƒ³å®šï¼‰ |

4) ä½¿ç”¨ä¾‹ï¼ˆã“ã®ãƒãƒ£ãƒ³ã‚¯å¤–ã‹ã‚‰ã¯ç›´æ¥æ§‹ç¯‰ä¸å¯ï¼‰
- å¤–éƒ¨ã‹ã‚‰ã®æ§‹ç¯‰æ–¹æ³•ã¯ä¸æ˜ï¼ˆã“ã®ãƒãƒ£ãƒ³ã‚¯ã«ã¯ç¾ã‚Œãªã„ï¼‰
- åŒä¸€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ãƒ†ã‚¹ãƒˆã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å¯èƒ½
```rust
// åŒä¸€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã§ã®ä¾‹ï¼ˆå¤–éƒ¨ã‹ã‚‰ã¯ä¸å¯ï¼‰
let r = Rectangle {
    top_left: Point { x: 2.0, y: 5.0 },
    bottom_right: Point { x: 10.0, y: 1.0 },
};
assert_eq!(r.width(), 8.0);
assert_eq!(r.height(), 4.0);
assert_eq!(r.area(), 32.0);
```

### Rectangle::width

1) ç›®çš„ã¨è²¬å‹™
- çŸ©å½¢ã®å¹…ï¼ˆxæ–¹å‘ã®è·é›¢ï¼‰ã‚’è¿”ã—ã¾ã™ã€‚

2) ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- `abs(bottom_right.x - top_left.x)`ã‚’è¿”ã™ï¼ˆ[è¡Œ34-36]ï¼‰ã€‚

3) å¼•æ•°

| å¼•æ•°å | å‹ | èª¬æ˜ |
|-------|----|------|
| self | &Rectangle | ãƒ¬ã‚·ãƒ¼ãƒ |

4) æˆ»ã‚Šå€¤

| å‹ | èª¬æ˜ |
|----|------|
| f64 | éè² ã®å¹…ã€‚NaN/Infinityã¯åº§æ¨™ã«æº–ã˜ã¦ä¼æ’­ |

5) ä½¿ç”¨ä¾‹
```rust
// åŒä¸€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã§ã®ä¾‹
let r = Rectangle {
    top_left: Point { x: 10.0, y: 10.0 },
    bottom_right: Point { x: 6.0, y: 8.0 },
};
assert_eq!(r.width(), 4.0);
```

6) ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹
- xåº§æ¨™ãŒåŒä¸€ã®å ´åˆã¯0.0
- åº§æ¨™ã«NaNãŒå«ã¾ã‚Œã‚‹ã¨NaN
- æ¥µç«¯ãªå€¤ã«ã‚ˆã‚ŠInfinityã«ãªã‚‹å¯èƒ½æ€§

### Rectangle::height

1) ç›®çš„ã¨è²¬å‹™
- çŸ©å½¢ã®é«˜ã•ï¼ˆyæ–¹å‘ã®è·é›¢ï¼‰ã‚’è¿”ã—ã¾ã™ã€‚

2) ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- `abs(bottom_right.y - top_left.y)`ã‚’è¿”ã™ï¼ˆ[è¡Œ38-40]ï¼‰ã€‚

3) å¼•æ•°

| å¼•æ•°å | å‹ | èª¬æ˜ |
|-------|----|------|
| self | &Rectangle | ãƒ¬ã‚·ãƒ¼ãƒ |

4) æˆ»ã‚Šå€¤

| å‹ | èª¬æ˜ |
|----|------|
| f64 | éè² ã®é«˜ã•ã€‚NaN/Infinityã¯åº§æ¨™ã«æº–ã˜ã¦ä¼æ’­ |

5) ä½¿ç”¨ä¾‹
```rust
// åŒä¸€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã§ã®ä¾‹
let r = Rectangle {
    top_left: Point { x: 1.0, y: 5.0 },
    bottom_right: Point { x: 6.0, y: 1.0 },
};
assert_eq!(r.height(), 4.0);
```

6) ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹
- yåº§æ¨™ãŒåŒä¸€ã®å ´åˆã¯0.0
- åº§æ¨™ã«NaNãŒå«ã¾ã‚Œã‚‹ã¨NaN
- æ¥µç«¯ãªå€¤ã«ã‚ˆã‚ŠInfinityã«ãªã‚‹å¯èƒ½æ€§

### Rectangle::area

1) ç›®çš„ã¨è²¬å‹™
- çŸ©å½¢ã®é¢ç©ï¼ˆå¹…Ã—é«˜ã•ï¼‰ã‚’è¿”ã—ã¾ã™ã€‚

2) ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- `self.width() * self.height()`ã‚’è¿”ã™ï¼ˆ[è¡Œ42-44]ï¼‰ã€‚

3) å¼•æ•°

| å¼•æ•°å | å‹ | èª¬æ˜ |
|-------|----|------|
| self | &Rectangle | ãƒ¬ã‚·ãƒ¼ãƒ |

4) æˆ»ã‚Šå€¤

| å‹ | èª¬æ˜ |
|----|------|
| f64 | é¢ç©ï¼ˆéè² ï¼‰ã€‚NaN/Infinityã¯å¯¸æ³•ã«æº–ã˜ã¦ä¼æ’­ |

5) ä½¿ç”¨ä¾‹
```rust
// åŒä¸€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å†…ã§ã®ä¾‹
let r = Rectangle {
    top_left: Point { x: 2.0, y: 5.0 },
    bottom_right: Point { x: 10.0, y: 1.0 },
};
assert_eq!(r.area(), 32.0);
```

6) ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹
- å¹…ã¾ãŸã¯é«˜ã•ãŒ0.0ãªã‚‰é¢ç©ã¯0.0
- å¹…/é«˜ã•ã®ã„ãšã‚Œã‹ãŒNaNãªã‚‰é¢ç©ã¯NaN
- å¹…ã¾ãŸã¯é«˜ã•ãŒInfinityãªã‚‰é¢ç©ã¯Infinityã¾ãŸã¯NaNï¼ˆã‚‚ã†ä¸€æ–¹ãŒ0.0ã®å ´åˆï¼‰

## Walkthrough & Data Flow

- å…¥åŠ›â†’å‡ºåŠ›ã®æµã‚Œ
  - multiply: å¼•æ•°x, yã‚’å—ã‘å–ã‚Šã€å˜ç´”ã«`x * y`ã‚’è¿”ã™ï¼ˆ[è¡Œ7-9]ï¼‰ã€‚å‰¯ä½œç”¨ãªã—ã€‚
  - Rectangleå¯¸æ³•è¨ˆç®—:
    - `width`: ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª­ã¿å–ã‚Šâ†’å·®åˆ†â†’çµ¶å¯¾å€¤â†’è¿”å´ï¼ˆ[è¡Œ34-36]ï¼‰
    - `height`: ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª­ã¿å–ã‚Šâ†’å·®åˆ†â†’çµ¶å¯¾å€¤â†’è¿”å´ï¼ˆ[è¡Œ38-40]ï¼‰
    - `area`: `width`ã¨`height`ã‚’é †ã«å‘¼ã³ã€ä¹—ç®—ã—ã¦è¿”å´ï¼ˆ[è¡Œ42-44]ï¼‰
- å†…éƒ¨é–¢æ•°
  - `Point::distance`: 2ç‚¹ã®å·®åˆ†ã‚’è¨ˆç®—ã—2ä¹—å’Œã®å¹³æ–¹æ ¹ã‚’è¿”å´ï¼ˆ[è¡Œ21-25]ï¼‰ã€‚å…¬é–‹APIã¨ã¯ç›´æ¥é€£ãªã£ã¦ã„ã¾ã›ã‚“ã€‚

ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã¯ç›´ç·šçš„ã§æ¡ä»¶åˆ†å²ãŒã»ã¼ãªã„ãŸã‚ã€Mermaidå›³ã¯ä½œæˆã—ã¾ã›ã‚“ï¼ˆä½¿ç”¨åŸºæº–ã«æº€ãŸãªã„ï¼‰ã€‚

## Complexity & Performance

- multiply: æ™‚é–“O(1)ã€ç©ºé–“O(1)
- Rectangle::width/height: æ™‚é–“O(1)ã€ç©ºé–“O(1)
- Rectangle::area: æ™‚é–“O(1)ã€ç©ºé–“O(1)ï¼ˆå†…éƒ¨ã§width/heightã‚’2å›å‘¼ã¶ãŒå®šæ•°æ™‚é–“ï¼‰

ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ãƒ»ã‚¹ã‚±ãƒ¼ãƒ«é™ç•Œ
- æµ®å‹•å°æ•°ç‚¹æ¼”ç®—ã®ç²¾åº¦ã¨ç‰¹æ®Šå€¤ï¼ˆNaN/Infinityï¼‰ã«ä¾å­˜ã€‚I/Oã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€DBã‚¢ã‚¯ã‚»ã‚¹ã¯å­˜åœ¨ã—ãªã„ãŸã‚ã‚¹ã‚±ãƒ¼ãƒ«å•é¡Œã¯ã»ã¼ãªã—ã€‚

å®Ÿé‹ç”¨è² è·è¦å› 
- å¤§è¦æ¨¡ç¹°ã‚Šè¿”ã—è¨ˆç®—ï¼ˆå¤§é‡ã®çŸ©å½¢å‡¦ç†ï¼‰ã§ã‚‚å„å‘¼ã³å‡ºã—ã¯å®šæ•°æ™‚é–“ã€‚SIMDæœ€é©åŒ–ã‚„ãƒãƒƒãƒæ¼”ç®—ãŒå¿…è¦ã«ãªã‚‹ã‚±ãƒ¼ã‚¹ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¬¡ç¬¬ï¼ˆã“ã®ãƒãƒ£ãƒ³ã‚¯ã«ã¯ç¾ã‚Œãªã„ï¼‰ã€‚

## Edge Cases, Bugs, and Security

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè©•ä¾¡
- ãƒ¡ãƒ¢ãƒªå®‰å…¨æ€§: unsafeãªã—ã€ãƒãƒƒãƒ•ã‚¡æ“ä½œãªã—ã€Use-after-freeãªã—ã€æ•´æ•°ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã®ã¿æ³¨æ„ï¼ˆ`add` [è¡Œ3-5]ï¼‰
- ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³: SQL/Command/Pathãªã—
- èªè¨¼ãƒ»èªå¯: è©²å½“ãªã—
- ç§˜å¯†æƒ…å ±: ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ç§˜å¯†ãªã—ã€ãƒ­ã‚°ãªã—
- ä¸¦è¡Œæ€§: å…±æœ‰çŠ¶æ…‹ãªã—ã€ãƒ‡ãƒ¼ã‚¿ç«¶åˆ/ãƒ‡ãƒƒãƒ‰ãƒ­ãƒƒã‚¯ãªã—

è©³ç´°ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹

| ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ | å…¥åŠ›ä¾‹ | æœŸå¾…å‹•ä½œ | å®Ÿè£… | çŠ¶æ…‹ |
|-------------|--------|----------|------|------|
| i32åŠ ç®—ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ | add(i32::MAX, 1) | ãƒ‡ãƒãƒƒã‚°ã§panic/ãƒªãƒªãƒ¼ã‚¹ã§ãƒ©ãƒƒãƒ— | `a + b`ï¼ˆ[è¡Œ3-5]ï¼‰ | è¦æ³¨æ„ï¼ˆéå…¬é–‹ã ãŒä»•æ§˜æ˜è¨˜æ¨å¥¨ï¼‰ |
| multiplyã§NaN | multiply(NaN, 1.0) | NaNã‚’è¿”ã™ | `x * y`ï¼ˆ[è¡Œ7-9]ï¼‰ | ä»•æ§˜é€šã‚Š |
| multiplyã§âˆÃ—0 | multiply(INFINITY, 0.0) | NaNã‚’è¿”ã™ | `x * y`ï¼ˆ[è¡Œ7-9]ï¼‰ | ä»•æ§˜é€šã‚Š |
| widthã®é€†é †åº§æ¨™ | top_left.x=10, bottom_right.x=2 | 8.0ï¼ˆéè² ï¼‰ | `abs`ä½¿ç”¨ï¼ˆ[è¡Œ34-36]ï¼‰ | OK |
| heightã®é€†é †åº§æ¨™ | top_left.y=1, bottom_right.y=10 | 9.0ï¼ˆéè² ï¼‰ | `abs`ä½¿ç”¨ï¼ˆ[è¡Œ38-40]ï¼‰ | OK |
| width/heightã§NaNåº§æ¨™ | ã„ãšã‚Œã‹ã®x/yãŒNaN | NaNã‚’è¿”ã™ | `f64`æ¼”ç®—ï¼ˆ[è¡Œ34-40]ï¼‰ | ä»•æ§˜é€šã‚Š |
| areaã§âˆå¯¸æ³• | å¹…=âˆ, é«˜ã•=æœ‰é™ | é¢ç©=âˆ | ä¹—ç®—ï¼ˆ[è¡Œ42-44]ï¼‰ | ä»•æ§˜é€šã‚Š |
| Point::distanceã§å·¨å¤§å€¤ | x,yãŒéå¸¸ã«å¤§ãã„ | âˆã¾ãŸã¯éå¸¸ã«å¤§ãã„å€¤ | `sqrt`ï¼ˆ[è¡Œ24]ï¼‰ | ä»•æ§˜é€šã‚Š |

Rustç‰¹æœ‰ã®è¦³ç‚¹
- æ‰€æœ‰æ¨©: `Point::new`ã¯`Self`ã‚’è¿”ã—ã¦æ‰€æœ‰æ¨©ç§»å‹•ï¼ˆ[è¡Œ17-19]ï¼‰ã€‚`Rectangle`ãƒªãƒ†ãƒ©ãƒ«ã‚‚æ‰€æœ‰æ¨©ç§»å‹•ã§å®‰å…¨ã€‚
- å€Ÿç”¨: `Point::distance(&self, other: &Point)`ã¯ä¸å¤‰å€Ÿç”¨ã§èª­ã¿å–ã‚Šã®ã¿ï¼ˆ[è¡Œ21]ï¼‰ã€‚å¯å¤‰å€Ÿç”¨ãªã—ã€‚
- ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ : æ˜ç¤ºçš„ãƒ©ã‚¤ãƒ•ã‚¿ã‚¤ãƒ ä¸è¦ã€‚å‚ç…§ã¯é–¢æ•°ã‚¹ã‚³ãƒ¼ãƒ—ã§å®Œçµã€‚
- unsafeå¢ƒç•Œ: unsafeãƒ–ãƒ­ãƒƒã‚¯ãªã—ï¼ˆè©²å½“ãªã—ï¼‰ã€‚
- ä¸¦è¡Œæ€§/éåŒæœŸ: Send/Syncå¢ƒç•Œã®ç‰¹åˆ¥ãªæŒ‡å®šãªã—ã€‚`Rectangle`ã¨`Point`ã¯`f64`ã®ã¿ã‚’ä¿æŒã—ã€æ¨™æº–çš„ã«`Send + Sync`ï¼ˆå‹ã«ã‚ˆã‚Šè‡ªå‹•å°å‡ºï¼‰ã ãŒã€ä¸¦è¡Œä½¿ç”¨ã®æƒ³å®šã¯ã“ã®ãƒãƒ£ãƒ³ã‚¯ã«ã¯ç¾ã‚Œãªã„ã€‚
- ã‚¨ãƒ©ãƒ¼è¨­è¨ˆ: `Result`/`Option`æœªä½¿ç”¨ã€‚panicã‚’èª˜ç™ºã™ã‚‹ã‚³ãƒ¼ãƒ‰ã¯ç„¡ã—ï¼ˆæ•´æ•°ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ¢ãƒ¼ãƒ‰ä¾å­˜ï¼‰ã€‚

## Design & Architecture Suggestions

- å…¬é–‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®è¿½åŠ 
  - `Rectangle`ã¯å¤–éƒ¨ã‹ã‚‰æ§‹ç¯‰ä¸å¯ã€‚ç”¨é€”æ‹¡å¼µã®ãŸã‚ã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã‚’è¿½åŠ æ¨å¥¨
    - `pub fn new(top_left: (f64, f64), bottom_right: (f64, f64)) -> Rectangle`
    - ã‚‚ã—ãã¯`Point`ã‚’`pub`ã«ã—ã€`pub fn new(top_left: Point, bottom_right: Point) -> Rectangle`
- ä¸å¤‰æ¡ä»¶ã®æ˜ç¤º/æº–æ‹ 
  - ã€Œå·¦ä¸Šã€ã€Œå³ä¸‹ã€ã®æ„å‘³è«–ã‚’æº€ãŸã™ã‚ˆã†ã€`new`ã§åº§æ¨™ã‚’æ­£è¦åŒ–ï¼ˆmin/maxï¼‰ã™ã‚‹ã‹ã€æ¤œè¨¼ã—ã¦ã‚¨ãƒ©ãƒ¼ï¼ˆResultï¼‰ã«ã™ã‚‹
- å‹ã®åˆ©ä¾¿æ€§å‘ä¸Š
  - `#[derive(Debug, Clone, Copy, PartialEq)]`ã®ä»˜ä¸ã§ä½¿ã„ã‚„ã™ã
- APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
  - `///`ã‚³ãƒ¡ãƒ³ãƒˆã§NaN/Infinityä¼æ’­ã€åº§æ¨™ã®å‰æã‚’æ˜è¨˜
- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã®è¿½åŠ 
  - `perimeter`, `contains(point)`, `intersects(other)`ãªã©ã€ä¸€èˆ¬çš„ãªçŸ©å½¢æ“ä½œã®è¶³å ´ã‚’ç”¨æ„ï¼ˆã“ã®ãƒãƒ£ãƒ³ã‚¯ã«ã¯ç¾ã‚Œãªã„ï¼‰

## Testing Strategy (Unit/Integration) with Examples

- æ–¹é‡
  - å˜ä½“ãƒ†ã‚¹ãƒˆã§å„APIã®æ­£å¸¸ç³»/å¢ƒç•Œå€¤/ç‰¹æ®Šå€¤ã‚’æ¤œè¨¼
  - `#[cfg(test)] mod tests`ã‚’åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã«ç½®ã‘ã°ã€éå…¬é–‹è¦ç´ ï¼ˆPoint, addï¼‰ã‚‚ãƒ†ã‚¹ãƒˆå¯èƒ½

- ã‚µãƒ³ãƒ—ãƒ«ãƒ†ã‚¹ãƒˆ
```rust
#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_multiply_basic() {
        assert_eq!(multiply(3.0, 2.0), 6.0);
        assert_eq!(multiply(-3.0, 2.0), -6.0);
        assert_eq!(multiply(0.0, 5.0), 0.0);
    }

    #[test]
    fn test_multiply_special_values() {
        let nan = f64::NAN;
        assert!(multiply(nan, 1.0).is_nan());
        assert!(multiply(f64::INFINITY, 0.0).is_nan());
        assert_eq!(multiply(f64::INFINITY, 2.0), f64::INFINITY);
    }

    #[test]
    fn test_rectangle_dimensions() {
        let r = Rectangle {
            top_left: Point { x: 2.0, y: 5.0 },
            bottom_right: Point { x: 10.0, y: 1.0 },
        };
        assert_eq!(r.width(), 8.0);
        assert_eq!(r.height(), 4.0);
        assert_eq!(r.area(), 32.0);
    }

    #[test]
    fn test_rectangle_reversed_coords() {
        let r = Rectangle {
            top_left: Point { x: 10.0, y: 10.0 },
            bottom_right: Point { x: 6.0, y: 8.0 },
        };
        assert_eq!(r.width(), 4.0);
        assert_eq!(r.height(), 2.0);
        assert_eq!(r.area(), 8.0);
    }

    #[test]
    fn test_point_distance() {
        let a = Point { x: 0.0, y: 0.0 };
        let b = Point { x: 3.0, y: 4.0 };
        // 3-4-5ä¸‰è§’å½¢
        assert_eq!(a.distance(&b), 5.0);
    }

    // æ³¨æ„: debugãƒ“ãƒ«ãƒ‰ã§ã®ã¿æˆç«‹ã€‚releaseã§ã¯ãƒ©ãƒƒãƒ—ã™ã‚‹ãŸã‚panicã—ãªã„ã€‚
    #[cfg(debug_assertions)]
    #[test]
    #[should_panic]
    fn test_add_overflow_panics_in_debug() {
        let _ = add(i32::MAX, 1);
    }
}
```

- è¿½åŠ æ¤œè¨
  - NaNåº§æ¨™ã®`Rectangle`ã§ã®å¯¸æ³•/é¢ç©ã®NaNä¼æ’­ãƒ†ã‚¹ãƒˆ
  - æ¥µå¤§/æ¥µå°å€¤ã§ã®Infinityä¼æ’­ãƒ†ã‚¹ãƒˆ

## Refactoring Plan & Best Practices

- APIæ‹¡å¼µ
  - `Rectangle::new(...)`ã‚’è¿½åŠ ã—ã€åº§æ¨™ã®æ­£è¦åŒ–ã‚„æ¤œè¨¼ã‚’å®Ÿæ–½ã€‚å¤±æ•—æ™‚ã¯`Result<Rectangle, Error>`ã§è¿”ã™è¨­è¨ˆã‚‚æ¤œè¨
- å¯èª­æ€§å‘ä¸Š
  - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚³ãƒ¡ãƒ³ãƒˆã¨ä¾‹ç¤ºã‚³ãƒ¼ãƒ‰ã®è¿½åŠ 
- æµ®å‹•å°æ•°ç‚¹ã®æ‰±ã„
  - æœŸå¾…ä»•æ§˜ï¼ˆNaN/Infinityã®æ‰±ã„ï¼‰ã‚’æ˜ç¤ºã€‚å¿…è¦ãªã‚‰`num_traits`ç­‰ã®å°å…¥ï¼ˆã“ã®ãƒãƒ£ãƒ³ã‚¯ã«ã¯ç¾ã‚Œãªã„ï¼‰
- æ•´æ•°æ¼”ç®—ã®å®‰å…¨åŒ–ï¼ˆå†…éƒ¨é–¢æ•°ã ãŒï¼‰
  - `add`ã‚’`checked_add`/`saturating_add`ã«å¤‰æ›´ã—ã¦ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼æŒ™å‹•ã‚’æ˜ç¢ºåŒ–ï¼ˆé–‹ç™ºæ™‚ã®æ··ä¹±è»½æ¸›ï¼‰
- ãƒ‡ãƒªãƒ™ãƒ¼ã‚·ãƒ§ãƒ³
  - `Rectangle`ã¨`Point`ã«`Copy/Clone/Debug/PartialEq`ã‚’ä»˜ä¸

## Observability (Logging, Metrics, Tracing)

- ç¾çŠ¶ã€ãƒ­ã‚®ãƒ³ã‚°ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ»ãƒˆãƒ¬ãƒ¼ã‚¹ã®å°å…¥ã¯ç„¡ã—ï¼ˆã“ã®ãƒãƒ£ãƒ³ã‚¯ã«ã¯ç¾ã‚Œãªã„ï¼‰
- å¿…è¦æ€§ã¯ä½ã„ãŒã€é¢ç©è¨ˆç®—ã®ç•°å¸¸æ¤œçŸ¥ï¼ˆNaN/Infinityï¼‰ã‚’ãƒ­ã‚°è­¦å‘Šã™ã‚‹æ‹¡å¼µã¯æœ‰ç”¨ãªå ´åˆã‚ã‚Š

## Risks & Unknowns

- `Rectangle`ã®å¤–éƒ¨æ§‹ç¯‰æ–¹æ³•: ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ä¸åœ¨ã§ã€å¤–éƒ¨ã‚³ãƒ¼ãƒ‰ãŒçŸ©å½¢ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å¾—ã‚‹çµŒè·¯ãŒä¸æ˜ï¼ˆã“ã®ãƒãƒ£ãƒ³ã‚¯ã«ã¯ç¾ã‚Œãªã„ï¼‰
- åº§æ¨™ã®æ„å‘³è«–: ã€Œå·¦ä¸Šã€ã€Œå³ä¸‹ã€ãŒå¸¸ã«ãã†ã§ã‚ã‚‹ä¿è¨¼ãŒãªã„ãŸã‚ã€ãƒ­ã‚¸ãƒƒã‚¯èª¤è§£ã®ãƒªã‚¹ã‚¯
- æµ®å‹•å°æ•°ç‚¹ã®ç‰¹æ®Šå€¤: NaN/Infinityä¼æ’­ä»•æ§˜ãŒåˆ©ç”¨å´ã§æœŸå¾…ã¨ç•°ãªã‚‹å¯èƒ½æ€§
- ãƒ“ãƒ«ãƒ‰ãƒ¢ãƒ¼ãƒ‰ä¾å­˜ã®æŒ™å‹•: `add`ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ãŒãƒ‡ãƒãƒƒã‚°/ãƒªãƒªãƒ¼ã‚¹ã§ç•°ãªã‚‹ã“ã¨ã«ã‚ˆã‚‹ãƒ†ã‚¹ãƒˆã®ä¸å®‰å®šã•ï¼ˆãŸã ã—éå…¬é–‹é–¢æ•°ï¼‰